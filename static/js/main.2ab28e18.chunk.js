(this["webpackJsonpdeviget-demo"]=this["webpackJsonpdeviget-demo"]||[]).push([[0],{100:function(e,t,n){},102:function(e,t,n){"use strict";n.r(t);var s,a=n(0),r=n.n(a),i=n(9),c=n.n(i),o=(n(87),n(16)),u=n(141),d=n(138),l=n(104),f=n(139),S=n(13);n(92);function O(e){if(e)if(e.post_hint){switch(e.post_hint.toLowerCase()){case"image":return s.IMAGE;case"hosted:video":return s.VIDEO;case"rich:video":return s.CONTENT_EMBED;case"self":return s.SELF;case"link":return s.LINK;default:return null}}else{if(e.selftext_html)return s.SELF;if(e.is_video)return s.VIDEO;if(e.secure_media&&e.secure_media.oembed&&e.secure_media.oembed.html)return s.CONTENT_EMBED}return s.IMAGE}!function(e){e[e.IMAGE=0]="IMAGE",e[e.VIDEO=1]="VIDEO",e[e.LINK=2]="LINK",e[e.SELF=3]="SELF",e[e.CONTENT_EMBED=4]="CONTENT_EMBED"}(s||(s={}));n(93);var h=n(2),v=function(e){var t=Object(S.c)((function(e){return e.selectedPost})),n=r.a.useCallback((function(e){var t=document.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue||""}),[]),a=r.a.useCallback((function(){if(!t)return null;var e=t.videoData||{};switch(t.postType){case s.IMAGE:return Object(h.jsx)("div",{className:"Body-content",children:Object(h.jsx)("div",{className:"PostPicture",style:{backgroundImage:"url(".concat(t.postUrl,")")}})});case s.VIDEO:return Object(h.jsx)("div",{className:"Body-content",children:Object(h.jsx)("video",{src:e.url,className:"Video",autoPlay:!0,controls:!0})});case s.LINK:return Object(h.jsx)("div",{className:"Body-content NotCentered",children:Object(h.jsx)("a",{href:t.postUrl,className:"Url",target:"_blank",children:t.postUrl})});case s.SELF:return Object(h.jsx)("div",{className:"Body-content NotCentered HtmlBody",dangerouslySetInnerHTML:{__html:n(t.postHtml)}});case s.CONTENT_EMBED:return Object(h.jsx)("div",{className:"Body-content EmbedVideo",dangerouslySetInnerHTML:{__html:n(t.embedContent)}});default:return null}}),[t,n]);if(!t)return null;var i=a();return Object(h.jsxs)("div",{className:"PostDetailContainer",children:[Object(h.jsx)("div",{className:"AuthorContainer",children:Object(h.jsx)("span",{className:"Author",children:t.author})}),Object(h.jsxs)("div",{className:"InnerContainer",style:i?t.postType!==s.SELF?{maxHeight:"calc(100% - 6em)"}:{}:{justifyContent:"center"},children:[Object(h.jsx)("span",{className:"Title",style:i?{}:{fontSize:"2.6em"},children:t.title}),i?Object(h.jsx)("div",{className:"Body",children:i}):null]})]})},b=n(142),m=n(137),E=n(140),P=n(143),_=n(136),j=n(77),T=n.n(j),I=n(55),p=n.n(I),g=n(75),D=n.n(g),A=n(76),R=n.n(A),y=n(68),N=n(29),C=n(17),k=n(21),M=function(){function e(){Object(C.a)(this,e),this.dbInstance=void 0,this.dbInstance=void 0}return Object(k.a)(e,[{key:"initDb",value:function(e,t,n){var s=this,a=e.target.result;a.createObjectStore("ReadPosts",{keyPath:"id"}),a.createObjectStore("DismissedPosts",{keyPath:"id"}),a.createObjectStore("SavedPosts",{keyPath:"id"}).createIndex("jsonData","jsonData",{unique:!1});var r=e.target.transaction;r.oncomplete=function(){s.dbInstance=a,t(a)},r.onerror=function(e){s.dbInstance=a,n(e)}}},{key:"getDBRef",value:function(){var e=this;return this.dbInstance?Promise.resolve(this.dbInstance):new Promise((function(t,n){var s=window.indexedDB.open("devgetDemo",1);s.onupgradeneeded=function(s){e.initDb(s,t,n)},s.onsuccess=function(n){var s=n.target.result;e.dbInstance=s,t(e.dbInstance)},s.onerror=function(e){n(e)}}))}},{key:"createDB",value:function(){return this.getDBRef()}},{key:"saveRead",value:function(e){var t=this;return this.getDBRef().then((function(){return new Promise((function(n,s){if(t.dbInstance){var a=t.dbInstance.transaction(["ReadPosts"],"readwrite");a.onerror=function(e){s(e)};var r=a.objectStore("ReadPosts").put({id:e});return r.onsuccess=function(e){n("")},void(r.onerror=function(e){s(e)})}s(new Error("Not created db"))}))}))}},{key:"saveDismissed",value:function(e){var t=this;return this.getDBRef().then((function(){return new Promise((function(n,s){if(t.dbInstance){var a=t.dbInstance.transaction(["DismissedPosts"],"readwrite");a.onerror=function(e){s(e)};var r=a.objectStore("DismissedPosts").put({id:e});return r.onsuccess=function(e){n("")},void(r.onerror=function(e){s(e)})}s(new Error("Not created db"))}))}))}},{key:"savePost",value:function(e){var t=this;return this.getDBRef().then((function(){return new Promise((function(n,s){if(t.dbInstance){var a=t.dbInstance.transaction(["SavedPosts"],"readwrite");a.onerror=function(e){s(e)};var r=a.objectStore("SavedPosts").put({id:e.id,jsonData:JSON.stringify(e)});return r.onsuccess=function(e){n("")},void(r.onerror=function(e){s(e)})}s(new Error("Not created db"))}))}))}},{key:"getSavedPosts",value:function(){var e=this;return this.getDBRef().then((function(){return new Promise((function(t,n){if(e.dbInstance){var s=e.dbInstance.transaction(["SavedPosts"],"readonly");s.onerror=function(e){n(e)};var a=s.objectStore("SavedPosts").getAll();return a.onsuccess=function(e){t((e.target.result||[]).map((function(e){var t=JSON.parse(e.jsonData);return t.createdTime=new Date(t.createdTimeUtc),t})))},void(a.onerror=function(e){n(e)})}n(new Error("Not created db"))}))}))}},{key:"saveDismissPosts",value:function(e){var t=this;return e&&e.length?this.getDBRef().then((function(){return new Promise((function(n,s){if(t.dbInstance){var a=t.dbInstance.transaction(["DismissedPosts"],"readwrite");a.onerror=function(e){s(e)};var r=a.objectStore("DismissedPosts"),i=[];e.forEach((function(e){var t=r.put({id:e});i.push(t),t.onsuccess=function(e){var t=!0;for(var s in i){var a=i[s];if(a&&"pending"===a.readyState){t=!1;break}}t&&n("")},t.onerror=function(e){s(e)}}))}else s(new Error("Not created db"))}))})):Promise.resolve(null)}},{key:"getDismissedKeys",value:function(){var e=this;return this.getDBRef().then((function(){return new Promise((function(t,n){if(e.dbInstance){var s=e.dbInstance.transaction(["DismissedPosts"],"readonly");s.onerror=function(e){n(e)};var a=s.objectStore("DismissedPosts").getAll();return a.onsuccess=function(e){t((e.target.result||[]).map((function(e){return e.id})))},void(a.onerror=function(e){n(e)})}n(new Error("Not created db"))}))}))}},{key:"removeSavedPost",value:function(e){var t=this;return this.getDBRef().then((function(){return new Promise((function(n,s){if(t.dbInstance){var a=t.dbInstance.transaction(["SavedPosts"],"readwrite");a.onerror=function(e){s(e)};var r=a.objectStore("SavedPosts").delete(e);return r.onsuccess=function(e){n(!0)},void(r.onerror=function(e){s(e)})}s(new Error("Not created db"))}))}))}},{key:"getAllReadKeys",value:function(){var e=this;return this.getDBRef().then((function(){return new Promise((function(t,n){if(e.dbInstance){var s=e.dbInstance.transaction(["ReadPosts"],"readonly");s.onerror=function(e){n(e)};var a=s.objectStore("ReadPosts").getAll();return a.onsuccess=function(e){t((e.target.result||[]).map((function(e){return e.id})))},void(a.onerror=function(e){n(e)})}n(new Error("Not created db"))}))}))}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}();M.instance=void 0;var x=function e(t,n,s,a){Object(C.a)(this,e),this.data=void 0,this.success=void 0,this.message=void 0,this.code=void 0,this.data=t,this.success=n,this.message=s,this.code=a},U=function e(){Object(C.a)(this,e)};U.REDDIT_BASE_URL="https://www.reddit.com/top.json",U.HTTP_TIMEOUT=4e4,U.ERRORS={TIMEOUT_CODE:-1},U.REDUX_ACTIONS={FETCH_REQUEST_POSTS:"fetch-request-posts",UPDATE_POST_LIST:"update-post-list",FAIL_REQUEST_POSTS:"fail-request-posts",DISMISS_POST:"dismiss-post",SELECT_POST:"select-post",READ_POSTS_IDS:"read-posts-ids",DISMISSED_POSTS_IDS:"dismissed-posts-ids",UPDATE_CURRENT_ERROR:"update-current-error",UPDATE_DONE_DISMISS_DATA:"update-done-dismiss-data",UPDATE_SAVED_POSTS:"update-saved-posts",SHOW_SAVED_POSTS:"show-saved-posts"},U.POST_LIST_PAGE_SIZES=[25,50,100],U.MOBILE_WIDHT_LIMIT_PX=1200,U.APP_MESSAGES={HTTP_TIMEOUT:"Connection timeout",ERROR_GET_POSTS:"Unable to get posts",REFRESH_BUTTON:"Refresh",DISMISS_ALL_BUTTON:"Dismiss All",ERROR_TITLE:"Error",DISMISS_BUTTON:"Dismiss",SAVE_BUTTON:"Save",REMOVE_BUTTON:"Remove",SAVED_POSTS:"Saved",LOADING:"Loading",ERROR_DISMISS_POST:"Unable to dismiss post",ERROR_DISMISS_POSTS:"Unable to dismiss posts",ERROR_SAVE_READ_POST:"Unable to save read post state",ERROR_GET_SAVED_POSTS:"Unable to retrieve saved posts",ERROR_SAVE_POST:"Unable to save post",PAGE_SIZE_PLC:"Page Size"};var w=function(){function e(){Object(C.a)(this,e),this.HTTP_TIMEOUT=U.HTTP_TIMEOUT}return Object(k.a)(e,[{key:"getPosts",value:function(e,t){var n=this,s=[t>0?"limit=".concat(t):null,e?"after=".concat(e):null];return Promise.race([new Promise((function(e,t){setTimeout((function(){t(new x(null,!1,U.APP_MESSAGES.HTTP_TIMEOUT,U.ERRORS.TIMEOUT_CODE))}),n.HTTP_TIMEOUT)})),fetch(U.REDDIT_BASE_URL+"?"+s.filter((function(e){return null!==e})).join("&")).then((function(e){return e.json()})).then((function(e){return e&&e.data&&e.data.children&&e.data.children.length?{list:e.data.children.map((function(e){return e.data})),after:e.data.after,before:e.data.before}:{}}))])}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}();w.instance=void 0;var L=function(){function e(){Object(C.a)(this,e),this.httpService=void 0,this.dbService=void 0,this.lastAuthorId="",this.httpService=w.getInstance(),this.dbService=M.getInstance()}return Object(k.a)(e,[{key:"getVideoData",value:function(e){return e&&e.reddit_video?{width:e.reddit_video.width,height:e.reddit_video.height,url:e.reddit_video.fallback_url}:null}},{key:"isValidThumbnailUrl",value:function(e){return!(!(e=(e||"").toLowerCase())||"default"===e||"self"===e)&&(e.endsWith(".jpg")||e.endsWith(".png")||e.endsWith(".gif")||e.endsWith(".jpeg"))&&e.length>5}},{key:"mapToPost",value:function(e){return e?{author:e.author_fullname,title:e.title,name:e.name,thumbnailUrl:this.isValidThumbnailUrl(e.thumbnail)?e.thumbnail:"",thumbnailDims:e.thumbnail_width&&e.thumbnail_height?{width:e.thumbnail_width,height:e.thumbnail_height}:null,id:e.id,createdTimeUtc:1e3*e.created_utc,subreddit:e.subreddit,postType:O(e),postHtml:e.selftext_html,postUrl:e.url_overridden_by_dest,createdTime:new Date(1e3*e.created_utc),numberOfComments:e.num_comments,embedContent:e.secure_media&&e.secure_media.oembed?e.secure_media.oembed.html:null,videoData:e.is_video&&e.media?this.getVideoData(e.media):null}:null}},{key:"getPostsAux",value:function(e,t){var n=this;return Promise.all([this.dbService.getDismissedKeys(),this.httpService.getPosts(this.lastAuthorId,e)]).then((function(s){var a=s[1]?s[1].list:[],r=s[1]?s[1].after:"",i=s[0].reduce((function(e,t){return e[t]=1,e}),{}),c=(a||[]).filter((function(e){return 1!==i[e.id]})).map((function(e){return n.mapToPost(e)}));if(c.length){if(t=[].concat(Object(N.a)(t),Object(N.a)(c)),r&&(n.lastAuthorId=r,localStorage.setItem("lastAuthorId",n.lastAuthorId||""),c.length<e))return n.getPostsAux(e-c.length,t)}else if(r&&n.lastAuthorId!==r)return n.lastAuthorId=r,n.getPostsAux(e,t);return t}))}},{key:"getPosts",value:function(e,t){return t&&(this.lastAuthorId=null),this.getPostsAux(e,[])}},{key:"getReadPosts",value:function(){return this.dbService.getAllReadKeys()}},{key:"getDismissedPosts",value:function(){return this.dbService.getDismissedKeys()}},{key:"saveDismissPost",value:function(e){return this.dbService.saveDismissed(e)}},{key:"getSavedPosts",value:function(){return this.dbService.getSavedPosts()}},{key:"savePost",value:function(e){return this.dbService.savePost(e)}},{key:"saveDismissPosts",value:function(e){return this.dbService.saveDismissPosts(e)}},{key:"removeSavedPost",value:function(e){return this.dbService.removeSavedPost(e)}},{key:"saveReadPost",value:function(e){return this.dbService.saveRead(e)}},{key:"savePageSize",value:function(e){localStorage.setItem("pageSize",e+"")}},{key:"getPageSize",value:function(){var e=localStorage.getItem("pageSize");return e?parseInt(e,10):null}},{key:"init",value:function(){return this.dbService.createDB()}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}();L.instance=void 0;var B=function(e){return{type:U.REDUX_ACTIONS.UPDATE_POST_LIST,payload:e}},G=function(e){return{type:U.REDUX_ACTIONS.UPDATE_SAVED_POSTS,payload:e}},H=function(e){return{type:U.REDUX_ACTIONS.READ_POSTS_IDS,payload:e}},V=function(e){return{type:U.REDUX_ACTIONS.SHOW_SAVED_POSTS,payload:e}},F=function(e){return{type:U.REDUX_ACTIONS.SELECT_POST,payload:e?e.id:null}},X=function(e){return{type:U.REDUX_ACTIONS.UPDATE_CURRENT_ERROR,payload:e}},z=function(e){return{type:U.REDUX_ACTIONS.UPDATE_DONE_DISMISS_DATA,payload:e}},W=function(e,t){return function(n,s){n({type:U.REDUX_ACTIONS.FETCH_REQUEST_POSTS,payload:null});var a=s().posts;return L.getInstance().getPosts(e,t).then((function(e){n(B(a.concat(e)))})).catch((function(e){n(function(e){return{type:U.REDUX_ACTIONS.FAIL_REQUEST_POSTS,payload:e}}(e)),n(X(e&&e.message?e.message:U.APP_MESSAGES.ERROR_GET_POSTS))}))}},K=function(){return function(e){return L.getInstance().getDismissedPosts().then((function(t){var n;e((n=t,{type:U.REDUX_ACTIONS.DISMISSED_POSTS_IDS,payload:n}))}))}},Q=function(){return function(e,t){return L.getInstance().getSavedPosts().then((function(t){e(G(t))})).catch((function(t){console.error(t),e(X(U.APP_MESSAGES.ERROR_GET_SAVED_POSTS))}))}},Z=(n(96),n(62)),J=n.n(Z),q=n(74),Y=n.n(q),$=n(132),ee=n(69),te=n.n(ee),ne=864e5,se=36e5,ae=function(e,t){var n=Object(a.useState)(!1),i=Object(o.a)(n,2),c=i[0],u=i[1],d=Object(a.useState)(!1),l=Object(o.a)(d,2),f=l[0],S=l[1],O=Object(a.useState)(!1),v=Object(o.a)(O,2),b=v[0],m=v[1],E=Object(a.useState)(!1),P=Object(o.a)(E,2),j=P[0],T=P[1],I=Object(a.useRef)(null),g=Object(a.useRef)(null),D=r.a.useCallback((function(t){var n=e.currentDate;if(n&&t){var s=n.getTime()+1e3*n.getTimezoneOffset()*60-t.getTime(),a=Math.floor(s/ne),r=Math.floor(s/6e4),i=Math.floor(s/se);if(s>0){if(s<6e4)return"Seconds ago";if(s<se)return"".concat(r," minute").concat(r>1?"s":""," ago");if(s<ne)return"".concat(i," hour").concat(i>1?"s":""," ago");if(s<432e6){var c=Math.floor(s%ne/se);return c>0?"".concat(a," day").concat(a>1?"s":"",", ").concat(c," hour").concat(c>1?"s":""," ago"):"".concat(a," day").concat(a>1?"s":""," ago")}return"".concat(a," day").concat(a>1?"s":""," ago")}}return""}),[e.currentDate]),A=e.post,R=r.a.useMemo((function(){return{paddingTop:"1px",paddingBottom:"1px",fontSize:"12px",marginRight:"5px"}}),[]);Object(a.useImperativeHandle)(t,(function(){return{fadeOut:function(){return I.current?Promise.reject("Animating"):(S(!0),new Promise((function(e){I.current=e})))},slideOut:function(e){return g.current?Promise.reject("Animating"):(e||m(!0),new Promise((function(t){g.current=t,e&&setTimeout((function(){m(!0)}),e)})))},id:A.id}}),[A]);var y=r.a.useMemo((function(){return new te.a.NumberFormat("en-IR")}),[]),N=r.a.useCallback((function(t){u(!0),e.onPress&&e.onPress(A)}),[e.onPress,A]),C=r.a.useCallback((function(t){t.stopPropagation(),e.onPressSave&&e.onPressSave(A)}),[e.onPressSave,A]),k=r.a.useCallback((function(e){u(!1),f&&I.current?I.current(!0):b&&g.current&&(T(!0),g.current(!0)),g.current=null,I.current=null,m(!1),S(!1)}),[A,f,b]),M=r.a.useCallback((function(t){t.stopPropagation(),e.onPressDismiss&&e.onPressDismiss(A)}),[e.onPressDismiss,A]),x=r.a.useCallback((function(t){t.stopPropagation(),e.onPressRemoved&&e.onPressRemoved(A)}),[e.onPressRemoved,A]),w=r.a.useMemo((function(){return c?" animate__animated animate__headShake":f?" animate__animated animate__fadeOut":b?" animate__animated animate__slideOutLeft":""}),[b,f,c]),L=r.a.useCallback((function(e){A.postType===s.IMAGE&&(e.stopPropagation(),window.open(A.postUrl,"_blank"))}),[A]);return e.post?Object(h.jsxs)("div",{className:"PostContainer "+w,style:j?{visibility:"hidden"}:{},onClick:N,onAnimationEnd:k,children:[Object(h.jsxs)("div",{className:"Header",children:[Object(h.jsxs)("div",{className:"Header-left",children:[e.read?null:Object(h.jsx)($.a,{className:"ReadIcon",children:"fiber_manual_record"}),Object(h.jsx)("span",{className:"Author",style:e.read?{left:0}:null,children:A.author})]}),Object(h.jsxs)("div",{className:"Header-right",children:[e.saved?Object(h.jsx)($.a,{className:"SavedIcon",children:"save"}):null,Object(h.jsx)("span",{className:"CreatedAt",children:D(A.createdTime)})]})]}),Object(h.jsxs)("div",{className:"Body",children:[A.thumbnailUrl?Object(h.jsx)("img",{src:A.thumbnailUrl,width:100,height:100,onClick:L,className:"Thumbnail "+(A.postType===s.IMAGE?"Clickable":"")}):null,Object(h.jsx)("span",{className:"Title",children:A.title})]}),Object(h.jsxs)("div",{className:"Footer",children:[Object(h.jsx)("div",{className:"PostOptions",children:e.saved?Object(h.jsx)(h.Fragment,{children:e.canRemove?Object(h.jsx)(_.a,{onClick:x,color:"default",size:"small",style:R,variant:"contained",className:"RemoveButton",startIcon:Object(h.jsx)(Y.a,{}),children:U.APP_MESSAGES.REMOVE_BUTTON}):Object(h.jsx)(_.a,{onClick:M,color:"default",size:"small",style:R,variant:"contained",className:"DismissButton",startIcon:Object(h.jsx)(J.a,{}),children:U.APP_MESSAGES.DISMISS_BUTTON})}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(_.a,{onClick:M,color:"default",size:"small",style:R,variant:"contained",className:"DismissButton",startIcon:Object(h.jsx)(J.a,{}),children:U.APP_MESSAGES.DISMISS_BUTTON}),Object(h.jsx)(_.a,{onClick:C,color:"default",size:"small",style:R,variant:"contained",className:"SaveButton",startIcon:Object(h.jsx)(p.a,{}),children:U.APP_MESSAGES.SAVE_BUTTON})]})}),Object(h.jsx)("span",{className:"CommentsNum",children:A.numberOfComments>0?y.format(A.numberOfComments)+" comment/s":"No comments"})]})]}):null},re=r.a.forwardRef(ae),ie=function(){function e(){Object(C.a)(this,e)}return Object(k.a)(e,null,[{key:"getWindowDimensions",value:function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}}]),e}(),ce=(n(100),function(e){var t=r.a.useMemo((function(){return L.getInstance()}),[]),n=Object(a.useState)(t.getPageSize()||U.POST_LIST_PAGE_SIZES[0]),s=Object(o.a)(n,2),i=s[0],c=s[1],u=Object(a.useState)(!1),d=Object(o.a)(u,2),l=d[0],f=d[1],O=Object(a.useState)(!1),v=Object(o.a)(O,2),j=v[0],I=v[1],g=Object(a.useState)(!1),A=Object(o.a)(g,2),C=A[0],k=A[1],M=Object(a.useState)(void 0),x=Object(o.a)(M,2),w=x[0],Z=x[1],J=Object(a.useState)(ie.getWindowDimensions()),q=Object(o.a)(J,2),Y=q[0],$=q[1];Object(a.useEffect)((function(){function e(){Z(void 0),$(ie.getWindowDimensions())}return Z(!0),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var ee=Object(S.b)(),te=Object(S.c)((function(e){return e.postsRead})),ne=Object(S.c)((function(e){return e.selectedPost})),se=Object(S.c)((function(e){return e.showSaved})),ae=r.a.useCallback((function(e){le.current={},ee(B([])),ee(W(e,!0)),ee((function(e){return L.getInstance().getReadPosts().then((function(t){e(H(t))}))})),ee(K()),ee(Q()),ee(V(!1))}),[ee]);Object(a.useEffect)((function(){l||t.init().then((function(){f(!0),ae(i)})).catch((function(){f(!0),ae(i)}))}),[t,ee]);var ce=Object(S.c)((function(e){return e.posts})),oe=Object(S.c)((function(e){return e.savedPosts})),ue=Object(S.c)((function(e){return e.fetchingPosts})),de=Object(S.c)((function(e){return e.dismissData})),le=Object(a.useRef)({}),fe=r.a.useCallback((function(e){e&&e.fadeOut().then((function(){ee(B(ce.filter((function(t){return t.id!==e.id})))),ee(z(void 0)),delete le.current[e.id]})).catch((function(){}))}),[ce,ee]),Se=r.a.useCallback((function(e){e&&e.fadeOut().then((function(){ee(G(oe.filter((function(t){return t.id!==e.id})))),ee(z(void 0)),delete le.current[e.id]})).catch((function(){}))}),[oe,ee]),Oe=r.a.useCallback((function(){var e=0,t=[];I(!0),ce.forEach((function(n,s){var a=le.current[n.id];e=Math.min(600,25*s),t.push(a.slideOut(e))})),Promise.all(t).then((function(){ee(z(void 0)),ee(B([])),le.current={},I(!1)})).catch((function(){I(!1)}))}),[ce,ee]),he=Object(a.useState)(0),ve=Object(o.a)(he,2),be=(ve[0],ve[1]);Object(a.useEffect)((function(){var e=ce;if(se&&(e=oe),e.length===Object.keys(le.current).length&&de)if("fadeOut"===de.type){ne&&ne.id===de.id&&ee(F(null));var t=le.current[de.id||""];se?Se(t):fe(t)}else"slideOut"===de.type&&(ee(F(null)),Oe())}),[de,Oe,Se,fe,ce,se,ne]);var me=r.a.useCallback((function(e){var t;ee((t=e.id,function(e,n){var s=L.getInstance();return s.saveReadPost(t).then((function(){var t=n().posts;s.getReadPosts().then((function(t){e(H(t))})),e(B(Object(N.a)(t)))})).catch((function(t){var s=n().posts;e(B(Object(N.a)(s))),e(X(U.APP_MESSAGES.ERROR_SAVE_READ_POST))}))})),ee(F(e)),Y.width<U.MOBILE_WIDHT_LIMIT_PX&&Z(!1)}),[ee,Y]),Ee=r.a.useCallback((function(e){ee(function(e){return function(t,n){var s=L.getInstance();return s.savePost(e).then((function(){return s.getSavedPosts().then((function(e){t(G(e))}))})).catch((function(e){var s=n().savedPosts;t(G(Object(N.a)(s))),t(X(U.APP_MESSAGES.ERROR_SAVE_READ_POST))}))}}(e))}),[ee,Y]),Pe=r.a.useCallback(Object(y.debounce)((function(e){!(e.target.scrollHeight-e.target.scrollTop<=1.1*e.target.clientHeight&&e.target.scrollTop>0)||ue||j||se||ee(W(i))}),350),[ee,i,ue,j,se]),_e=r.a.useMemo((function(){return te.reduce((function(e,t){return e[t]=1,e}),{})}),[te]),je=r.a.useMemo((function(){return oe.reduce((function(e,t){return e[t.id]=1,e}),{})}),[oe]),Te=r.a.useCallback((function(e){var t;ee((t=e.id,function(e,n){return L.getInstance().saveDismissPost(t).then((function(){e(z({type:"fadeOut",id:t}))})).catch((function(t){e(X(U.APP_MESSAGES.ERROR_DISMISS_POST))}))}))}),[ee]),Ie=r.a.useCallback((function(e,t){e?le.current[t]=e:delete le.current[t]}),[]),pe=r.a.useCallback((function(e){var t;ee((t=e.id,function(e,n){return L.getInstance().removeSavedPost(t).then((function(){e(z({type:"fadeOut",id:t}))})).catch((function(){e(X(U.APP_MESSAGES.ERROR_SAVE_READ_POST))}))}))}),[ee]),ge=r.a.useMemo((function(){var e=ce;return se&&(e=oe),e.map((function(e){return Object(h.jsx)(re,{post:e,currentDate:new Date,saved:void 0!==je[e.id],read:void 0!==_e[e.id],canRemove:se&&void 0!==je[e.id],onPressRemoved:pe,onPressDismiss:Te,onPress:me,onPressSave:Ee,ref:function(t){return Ie(t,e.id)}},e.id)}))}),[ce,_e,se,oe,je]),De=r.a.useCallback((function(e){e&&e.target&&e.target.value&&(ee(V(!1)),c(e.target.value),t.savePageSize(e.target.value),ae(e.target.value))}),[ae,t,ee]),Ae=r.a.useCallback((function(e){ee(V(!1)),ae(i)}),[ae,i,ee]),Re=r.a.useCallback((function(e){if(!j){ee(V(!1));var t=ce.map((function(e){return e.id}));ee(function(e){return function(t,n){return L.getInstance().saveDismissPosts(e).then((function(){t(z({type:"slideOut"}))})).catch((function(e){t(X(U.APP_MESSAGES.ERROR_DISMISS_POSTS))}))}}(t))}}),[j,ce,ee]),ye=r.a.useCallback((function(e){j||(se?(le.current={},ee(V(!1))):(le.current={},ee(V(!0)),ee(Q()),be(Math.random())))}),[j,ce,ee,se]),Ne=r.a.useCallback((function(){k(!1)}),[]),Ce=r.a.useCallback((function(){C||(Z((function(e){return!e})),k(!0))}),[C]),ke=r.a.useMemo((function(){return U.POST_LIST_PAGE_SIZES.map((function(e){return Object(h.jsx)(b.a,{value:e,children:e},e)}))}),[]);return Object(h.jsxs)("div",{className:"PostListContainer",children:[Object(h.jsx)(m.a,{"aria-label":"delete",className:"MenuButton ",onClick:Ce,children:Object(h.jsx)(D.a,{fontSize:"large"})}),Object(h.jsxs)("div",{className:"PostListBody "+(Y.width<U.MOBILE_WIDHT_LIMIT_PX&&void 0!==w?w?"animate__animated animate__slideInLeft":"animate__animated animate__slideOutLeft":""),onAnimationEnd:Ne,children:[Object(h.jsxs)("div",{className:"PostListOptions",children:[Object(h.jsxs)(E.a,{value:i,className:"Option PageSizeDropdown",onChange:De,input:Object(h.jsx)(P.a,{placeholder:U.APP_MESSAGES.PAGE_SIZE_PLC,style:{paddingLeft:"12px"}}),children:[Object(h.jsx)(b.a,{value:"",children:Object(h.jsx)("em",{children:U.APP_MESSAGES.PAGE_SIZE_PLC})}),ke]}),Object(h.jsx)(_.a,{variant:"contained",className:"Option ReloadButton",onClick:Ae,endIcon:Object(h.jsx)(R.a,{}),children:U.APP_MESSAGES.REFRESH_BUTTON}),se?null:Object(h.jsx)(_.a,{variant:"contained",className:"Option DismissAllButton",onClick:Re,endIcon:Object(h.jsx)(T.a,{}),children:U.APP_MESSAGES.DISMISS_ALL_BUTTON}),Object(h.jsx)(_.a,{variant:"contained",className:"Option SavedPostsButton "+(se?"SavedButtonFocus":""),onClick:ye,endIcon:Object(h.jsx)(p.a,{}),children:U.APP_MESSAGES.SAVED_POSTS})]}),Object(h.jsx)("div",{className:"PostListInnerContainer",style:ge.length?{}:{border:"none"},onScroll:Pe,children:ge})]})]})});n(101);var oe=function(){var e=r.a.useState(!1),t=Object(o.a)(e,2),n=t[0],s=t[1],i=Object(S.b)(),c=Object(S.c)((function(e){return e.fetchingPosts})),O=Object(S.c)((function(e){return e.currentError})),b=r.a.useCallback((function(){s(!1),i(X(""))}),[i]);return Object(a.useEffect)((function(){s(!(!c&&!O))}),[c,O]),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(ce,{}),Object(h.jsx)(v,{}),Object(h.jsx)(u.a,{"aria-labelledby":"spring-modal-title","aria-describedby":"spring-modal-description",className:"Modal",open:n,onClose:b,closeAfterTransition:!0,disableBackdropClick:c,BackdropComponent:d.a,BackdropProps:{timeout:500},children:Object(h.jsx)(l.a,{in:n,children:O?Object(h.jsxs)("div",{className:"Paper",children:[Object(h.jsx)("span",{className:"Modal-title",children:U.APP_MESSAGES.ERROR_TITLE}),Object(h.jsx)("span",{className:"Modal-description",children:O})]}):c?Object(h.jsxs)("div",{className:"Paper",children:[Object(h.jsxs)("span",{className:"Modal-title",children:[U.APP_MESSAGES.LOADING,"..."]}),Object(h.jsx)(f.a,{color:"secondary"})]}):Object(h.jsx)("div",{})})})]})},ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,144)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),s(e),a(e),r(e),i(e)}))},de=n(42),le=n(11),fe={posts:[],selectedPost:null,fetchingPosts:!1,currentError:"",postsRead:[],dismissData:void 0,savedPosts:[],showSaved:!1},Se=n(78),Oe=Object(de.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U.REDUX_ACTIONS.UPDATE_POST_LIST:return Object(le.a)(Object(le.a)({},e),{},{posts:t.payload,fetchingPosts:!1});case U.REDUX_ACTIONS.FAIL_REQUEST_POSTS:return Object(le.a)(Object(le.a)({},e),{},{fetchingPosts:!1});case U.REDUX_ACTIONS.SELECT_POST:return Object(le.a)(Object(le.a)({},e),{},{selectedPost:e.showSaved?e.savedPosts.find((function(e){return e.id===t.payload})):e.posts.find((function(e){return e.id===t.payload}))});case U.REDUX_ACTIONS.FETCH_REQUEST_POSTS:return Object(le.a)(Object(le.a)({},e),{},{fetchingPosts:!0});case U.REDUX_ACTIONS.UPDATE_CURRENT_ERROR:return Object(le.a)(Object(le.a)({},e),{},{currentError:t.payload});case U.REDUX_ACTIONS.READ_POSTS_IDS:return Object(le.a)(Object(le.a)({},e),{},{postsRead:t.payload});case U.REDUX_ACTIONS.UPDATE_DONE_DISMISS_DATA:return Object(le.a)(Object(le.a)({},e),{},{dismissData:t.payload});case U.REDUX_ACTIONS.UPDATE_SAVED_POSTS:return Object(le.a)(Object(le.a)({},e),{},{savedPosts:t.payload});case U.REDUX_ACTIONS.SHOW_SAVED_POSTS:return Object(le.a)(Object(le.a)({},e),{},{showSaved:t.payload});default:return e}}),Object(de.a)(Se.a));c.a.render(Object(h.jsx)(S.a,{store:Oe,children:Object(h.jsx)(oe,{})}),document.getElementById("root")),ue()},87:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},96:function(e,t,n){},98:function(e,t){}},[[102,1,2]]]);
